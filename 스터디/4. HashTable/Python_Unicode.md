[출처: 파이썬 라이브러리](https://wikidocs.net/134567)

# Intro : 유니코드(Unicode)의 등장 배경

컴퓨터는 0과 1라는 값만을 인식할 수 있느 기계 장치이다.  
따라서, 컴퓨터가 문자를 인식하게 해주려면 문자셋 표준이 필요하다. (ex.ASCII)  

영어권 국가들은 아스키코드를 쓰면 되겠지만, 다른 비 영어권 국가들은 아스키 코드를 사용할 수 없다.  
따라서, 각 국가들에게 맞는 문자셋들이 나오게 되었는데(ex. 한국: KSC5601)  
이렇게 나라별로 문자셋이 만들어졌기 때문에 하나의 문서에 여러나라의 언어를 동시에 표현할 수 있는 방법이 없었다.

이런 문제를 해결하기 위해 등장한 것이 유니코드(Unicode)이다.  
유니코드는 모든 나라의 문자를 다 포함하게끔 넉넉하게 설계되었고, 곧 세계적인 표준이 되었다.  
유니코드의 규칙을 사용하게 되면 서로 다른 문자셋으로 고생할 일이 없어졌다.  

# 1. 인코딩(encoding)

다음 예시를 보면, type 함수를 호출해 보면 문자열은 str 클래스의 객체임을 알 수 있다.


```python
s = "Hello World"
print(type(s))
```

    <class 'str'>


파이썬에서 사용되는 문자열은 모두 **유니코드 문자열**이다.(Python3 버전부터는 모든 문자열을 유니코드로 처리하게 변경됨.)  

유니코드 문자열을 인코딩 없이 그대로 파일에 적거나 다른 시스템으로 네트워크 전송을 할 수는 없다.  
왜냐하면 유니코드 문자열은 단순히 문자셋의 규칙이기 때문이다.  
파일에 적거나 다른 시스템으로 유니코드 문자열을 전송하기 위해서는 **<u>바이트</u>**로 변환해야만 한다.  

**이렇게 <u>유니코드 문자열을 바이트로 바꾸는 것을 인코딩</u>이라고 한다.**  

따라서 파일을 읽거나 바이트 문자열을 수신받을 때에는 **해당 바이트가 어떤 방식의 인코딩을 사용했는지**는 필수적으로 미리 알고 있어야만 **디코딩**이 가능하다.

### 예시) 유니코드 문자열 -> 바이트 문자열 (인코딩)


```python
a = "ㅎㅇ"
b = a.encode() # 이렇게 파라미터를 생략하면 "utf-8"이 디폴트값으로 동작
c = a.encode("utf-8") 
d = a.encode("euc-kr") # euc-kr 방식도 한글 인코딩 가능
print(b)
print(c)
print(d)

```

    b'\xe3\x85\x8e\xe3\x85\x87'
    b'\xe3\x85\x8e\xe3\x85\x87'
    b'\xa4\xbe\xa4\xb7'



```python
e = a.encode("ascii") # 아스키 방식으로 'ㅎㅇ'라는 유니코드 문자열을 바이트로 변경할 수 없음.
print(e)
```


    ---------------------------------------------------------------------------

    UnicodeEncodeError                        Traceback (most recent call last)

    /var/folders/hq/xf8_tpq56wn23gb8332bc7yw0000gn/T/ipykernel_34584/3102635250.py in <module>
    ----> 1 e = a.encode("ascii") # 아스키 방식으로 'ㅎㅇ'라는 유니코드 문자열을 바이트로 변경할 수 없음.
          2 print(e)


    UnicodeEncodeError: 'ascii' codec can't encode characters in position 0-1: ordinal not in range(128)


# 2. 디코딩

이번에는 예제를 통해 반대로 인코딩된 문자열을 유니코드 문자열로 변환할 수 있는 디코딩에 대해 알아보자.  

- 예제 1)


```python
a = '한글'
b = a.encode()
print(b.decode("utf-8")) 
```

위와 같이 "utf-8"로 인코딩된 바이트 문자열이 "utf-8"로 디코딩되었다.  

- 예제 2)


```python
d = a.encode("euc-kr")
print(d.decode()) 
```

위와 같이 "euc-kr"로 인코딩된 바이트 문자열이 "utf-8"로 디코딩하려하자 오류가 뜨는 모습!

# 3. 입출력과 인코딩

인코딩 관련해서 개발자들이 가장 고생하는 부분은 바로 데이터의 입출력 관련해서이다.  
이것 역시 문자열과 인코딩에 대한 개념만 확실히 이해하면 어렵지 않지만 이것들에 대한 이해 없이 무작정 인코딩, 디코딩을 사용하면 다중 인코딩되거나 다중 디코딩되면서 문자열이 꼬여 버리는 불상사가 발생하기도 한다.

파일을 읽거나 네트워크를 통해 데이터를 입력받을 때 추천하는 방법은 다음과 같다.

1. 입력으로 받은 바이트 문자열을 가능한한 가장 빨리 유니코드 문자열로 디코딩 할 것.
1. 변환된 유니코드 문자열로만 함수나 클래스등에서 사용할 것.
1. 입력에 대한 결과를 전송하는 마지막 부분에서만 유니코드 문자열을 바이트 문자열로 인코딩해서 리턴할 것.  

위와 같은 규칙을 준수한다면 인코딩 관련해서 큰 어려움이 없을 것이다.

다음은 euc-kr 방식으로 작성되어진 파일을 읽고 변경하여 저장하는 예제이다.


```python
# 1. euc-kr로 작성된 파일 읽기
with open('euc_kr.txt', encoding='euc-kr') as f:
    data = f.read()  # 유니코드 문자열 

# 2. unicode 문자열로 프로그램 수행하기
data = data + "\n" + "추가 문자열"

# 3. euc-kr로 수정된 문자열 저장하기
with open('euc_kr.txt', encoding='euc-kr', mode='w') as f:
    f.write(data)
```

# 4. 소스코드 인코딩

파이썬 셸이 아닌 에디터로 파이썬 코딩을 할 경우 **소스 코드의 인코딩은 매우 중요하다**. 소스 코드의 인코딩이란 소스 코드 파일이 현재 **어떤 방식으로 인코딩되었지**를 의미한다.

우리가 위 예제에서 알아보았듯이 파일은 utf-8 인코딩으로 저장할 수도 있고 euc-kr로 저장할 수도 있었다.  
소스 코드도 파일이므로 인코딩 타입이 반드시 존재한다.   

파이썬은 소스코드의 인코딩을 명시하기 위해 소스 코드 제일 상단에 다음과 같은 문장을 넣어 주어야 한다.


```python
# -*- coding: utf-8 -*-
```

만약 소스코드가 utf-8로 인코딩된 파일이라면 위와 같이 작성하면 되고 euc-kr로 인코딩된 경우라면 다음과 같이 작성해야 한다.  
> 파이썬 3.0 부터는 utf-8이 디폴트이므로 utf-8로 인코딩된 소스 코드인 경우 위 문장을 생략 해도 된다.


```python
# -*- coding: euc-kr -*-
```

만약 소스코드는 euc-kr로 인코딩되었는데 파일상단에는 utf-8로 명시되어져 있다면 문자열 처리하는 부분에서 인코딩 관련한 오류가 발생할 것이다.
